
(("dateCreated" :datetime (20717 22888)) ("description" . "<?xml version=\"1.0\" encoding=\"utf-8\"?>
<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"
               \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">
<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\" xml:lang=\"en\">
<head>
<title>odbc备忘</title>







<style type=\"text/css\">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type=\"text/javascript\">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = \"code-highlighted\";
     elem.className   = \"code-highlighted\";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>
<div id=\"org-div-home-and-up\" style=\"text-align:right;font-size:70%;white-space:nowrap;\">
 <a accesskey=\"h\" href=\"/liweilijie\"> UP </a>
 |
 <a accesskey=\"H\" href=\"/liweilijie\"> HOME </a>
</div>

<div id=\"preamble\">

</div>

<div id=\"content\">
<h1 class=\"title\">odbc备忘</h1>


<div id=\"table-of-contents\">
<h2>Table of Contents</h2>
<div id=\"text-table-of-contents\">
<ul>
<li><a href=\"#sec-1\">1 odbc概述</a></li>
<li><a href=\"#sec-2\">2 操作</a></li>
<li><a href=\"#sec-3\">3 Diagnostics &amp; Error Status Codes</a>
<ul>
<li><a href=\"#sec-3-1\">3.1 Contents</a></li>
<li><a href=\"#sec-3-2\">3.2 Introduction</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id=\"outline-container-1\" class=\"outline-2\">
<h2 id=\"sec-1\"><span class=\"section-number-2\">1</span> odbc概述</h2>
<div class=\"outline-text-2\" id=\"text-1\">


<p>
  odbc是一个应用程序与数据库之间连接的中间驱动。
</p>
</div>

</div>

<div id=\"outline-container-2\" class=\"outline-2\">
<h2 id=\"sec-2\"><span class=\"section-number-2\">2</span> 操作</h2>
<div class=\"outline-text-2\" id=\"text-2\">


</div>

</div>

<div id=\"outline-container-3\" class=\"outline-2\">
<h2 id=\"sec-3\"><span class=\"section-number-2\">3</span> Diagnostics &amp; Error Status Codes</h2>
<div class=\"outline-text-2\" id=\"text-3\">


<p>
  有关odbc函数的诊断(diagnostics)和返回的错误代码值情况如下:
</p>
<p>
  <a href=\"http://www.easysoft.com/developer/interfaces/odbc/diagnostics_error_status_codes.html\">http://www.easysoft.com/developer/interfaces/odbc/diagnostics_error_status_codes.html</a>
</p>


</div>

<div id=\"outline-container-3-1\" class=\"outline-3\">
<h3 id=\"sec-3-1\"><span class=\"section-number-3\">3.1</span> Contents</h3>
<div class=\"outline-text-3\" id=\"text-3-1\">


<ul>
<li>Introduction                                                                                                           
</li>
<li>ODBC Status Returns                                                                                                    
</li>
<li>Obtaining Diagnostics                                                                                                  
</li>
<li>Diagnostic Fields                                                                                                      
</li>
<li>Example Diagnostic Messages                                                                                            
</li>
<li>Appendix A: ODBC Status Return Codes                                                                                   
</li>
<li>Appendix B: ODBC 2 to ODBC 3 SQLSTATE Mappings                                                                         
</li>
</ul>


</div>

</div>

<div id=\"outline-container-3-2\" class=\"outline-3\">
<h3 id=\"sec-3-2\"><span class=\"section-number-3\">3.2</span> Introduction</h3>
<div class=\"outline-text-3\" id=\"text-3-2\">


<p>                                                                                                                           
This document aims to provide a brief introduction to ODBC diagnostics and status return codes.                            
</p>
<p>                                                                                                                           
We begin with an explanation of how ODBC Status return codes are formed, the meaning that this form has and then move onto 
how diagnostic information is retrieved and dealt with.                                                                    
</p>
<p>                                                                                                                           
Finally, there are links to some, rather long, pages that list all the ODBC status codes and the ODBC API functions that   
can return them, complete with brief descriptions.                                                                         
</p>
<p>                                                                                                                           
ODBC Status Returns                                                                                                        
</p>
<p>                                                                                                                           
SQLGetDiagRec or SQLGetDiagField returns SQLSTATE values as defined by X/Open Data Management: Structured Query Language   
(SQL), Version 2 (March 1995). SQLSTATE values are strings that contain five characters. Appendixes A &amp; B tables lists     
SQLSTATE values that a driver can return for SQLGetDiagRec.                                                                
</p>
<p>                                                                                                                           
The character string value returned for an SQLSTATE consists of a two-character class value followed by a three-character  
subclass value. A class value of \"01\" indicates a warning and is accompanied by a return code of SQL_SUCCESS_WITH_INFO.    
Class values other than \"01,\" except for the class \"IM,\" indicate an error and are accompanied by a return value of        
SQL_ERROR. The class \"IM\" is specific to warnings and errors that derive from the implementation of ODBC itself. The       
subclass value \"000\" in any class indicates that there is no subclass for that SQLSTATE. The assignment of class and       
subclass values is defined by SQL-92.                                                                                      
</p>
<p>                                                                                                                           
Note:Although successful execution of a function is normally indicated by a return value of SQL_SUCCESS, the SQLSTATE 00000
also indicates success.                                                                                                    
</p>
<p>                                                                                                                           
All ODBC API's return a status value which may be used to check whether the function succeeded or not. In C you can test   
the return value from an ODBC function using the macro SQL_SUCCEEDED                                                       
</p>
<p>                                                                                                                           
e.g.                                                                                                                       
</p>


<div class=\"cnblogs_Highlighter\">
<pre class=\"brush:cpp\">

  SQLRETURN fsts;                                                                                                            
  /* Assume for this example the environment has already been allocated */                                                   
  SQLHENV envh;                                                                                                              
  SQLHDBC dbch;                                                                                                              
  fsts = SQLAllocHandle(SQL_HANDLE_DBC, envh, &dbch);                                                                        
  if (!SQL_SUCCEEDED(fsts))                                                                                                  
  {                                                                                                                          
    /* an error occurred allocating the database handle */                                                                   
  }                                                                                                                          
  else                                                                                                                       
  {                                                                                                                          
    /* Database handle allocated OK */                                                                                       
  }                                                                                                                          


</pre>
</div>


<p>                                                                                                                           
The macro <b>SQL_SUCCEEDED</b> is defined as:                                                                                     
</p>


<div class=\"cnblogs_Highlighter\">
<pre class=\"brush:cpp\">

    #define SQL_SUCCEEDED(rc) (((rc)&(~1))==0)                                                                                 


</pre>
</div>

<p>                                                                                                                           
Virtually all ODBC functions can return two values which indicate success                                                  
</p>
<ul>
<li>SQL_SUCCESS                                                                                                            
</li>
<li>SQL_SUCCESS_WITH_INFO                                                                                                  
</li>
</ul>


<p>                                                                                                                           
Both of these returns cause the SQL_SUCCEEDED macro to result in <b>1</b>.                                                        
</p>
<p>                                                                                                                           
If a function returns <b>SQL_SUCCESS_WITH_INFO</b> it means that the call succeeded but an informational message was produced.    
</p>
<p>                                                                                                                           
e.g. with some drivers you might set the cursor type, prepare a statement and then execute it. When SQLExecute is called   
the statement is acted upon but the driver might change the cursor type to something else. In this case, SQLExecute would  
return <b>SQL_SUCCESS_WITH_INFO</b> and the driver would add a diagnostic indicating the cursor type had been changed.            
</p>
<p>                                                                                                                           
You should note that a few ODBC functions return a status which fails the SQL_SUCCEEDED macro but do not indicate an error 
as such.                                                                                                                   
</p>
<p>                                                                                                                           
e.g. SQLFetch can return SQL_NO_DATA indicating there is no further rows in the result set, this is not necessarily an     
error.                                                                                                                     
</p></div>
</div>
</div>
</div>

<div id=\"postamble\">
<p class=\"date\">Date: 2013-01-09 WED</p>
<p class=\"author\">Author: liweilijie</p>
<p class=\"creator\"><a href=\"http://orgmode.org\">Org</a> version 7.9.2 with <a href=\"http://www.gnu.org/software/emacs/\">Emacs</a> version 23</p>
<a href=\"http://validator.w3.org/check?uri=referer\">Validate XHTML 1.0</a>

</div>
</body>
</html>
") ("title" . "odbc备忘") ("categories" "[随笔分类]C") ("enclosure" ("length" . 0)) ("link" . "http://www.cnblogs.com/liweilijie/archive/2013/01/09/2852597.html") ("permalink" . "http://www.cnblogs.com/liweilijie/archive/2013/01/09/2852597.html") ("postid" . 2852597) ("source") ("mt_excerpt" . "odbc学习") ("mt_keywords" . "odbc"))
